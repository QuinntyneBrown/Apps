<div class="shopping-lists">
  <div class="shopping-lists__header">
    <h1 class="shopping-lists__title">Shopping Lists</h1>
  </div>

  @if (loading$ | async) {
    <div class="shopping-lists__loading">
      <mat-spinner></mat-spinner>
    </div>
  } @else {
    @if (shoppingLists$ | async; as shoppingLists) {
      @if (shoppingLists.length === 0) {
        <div class="shopping-lists__empty">
          <mat-icon>shopping_cart</mat-icon>
          <p>No shopping lists found. Create your first shopping list!</p>
        </div>
      } @else {
        <div class="shopping-lists__grid">
          @for (list of shoppingLists; track list.shoppingListId) {
            <mat-card class="shopping-lists__card">
              <mat-card-header>
                <mat-card-title class="shopping-lists__card-title">
                  {{ list.name }}
                </mat-card-title>
                <mat-checkbox
                  [checked]="list.isCompleted"
                  (change)="toggleCompleted(list)"
                  class="shopping-lists__checkbox"
                >
                  Completed
                </mat-checkbox>
              </mat-card-header>

              <mat-card-content class="shopping-lists__content">
                <div class="shopping-lists__date">
                  Created: {{ list.createdDate | date: 'mediumDate' }}
                </div>
                @if (list.completedDate) {
                  <div class="shopping-lists__date">
                    Completed: {{ list.completedDate | date: 'mediumDate' }}
                  </div>
                }
                <div class="shopping-lists__items">
                  <strong>Items:</strong>
                  <pre class="shopping-lists__items-text">{{ list.items }}</pre>
                </div>
                @if (list.notes) {
                  <div class="shopping-lists__notes">
                    <strong>Notes:</strong>
                    <p>{{ list.notes }}</p>
                  </div>
                }
              </mat-card-content>

              <mat-card-actions>
                <button mat-button color="warn" (click)="onDelete(list.shoppingListId)">
                  <mat-icon>delete</mat-icon>
                  Delete
                </button>
              </mat-card-actions>
            </mat-card>
          }
        </div>
      }
    }
  }
</div>
