@startuml RecipeManager Domain Model

!define AGGREGATE_ROOT #LightBlue
!define ENTITY #LightYellow
!define VALUE_OBJECT #LightGreen

package "Recipe Management" AGGREGATE_ROOT {
  class Recipe <<Aggregate Root>> {
    + Id: Guid
    + Name: string
    + Cuisine: CuisineType
    + PrepTime: TimeSpan
    + CookTime: TimeSpan
    + Servings: int
    + Difficulty: DifficultyLevel
    + Source: string
    + CreatedBy: Guid
    + CreatedAt: DateTime
    --
    + UpdateDetails()
    + AddRating()
    + UpdateNutrition()
  }

  class RecipeIngredient <<Value Object>> VALUE_OBJECT {
    + Name: string
    + Quantity: decimal
    + Unit: Unit
    + Notes: string
    + Optional: bool
    + Category: string
  }

  class RecipeInstruction <<Value Object>> VALUE_OBJECT {
    + StepNumber: int
    + Description: string
    + Duration: TimeSpan
  }

  class Rating <<Entity>> ENTITY {
    + Id: Guid
    + RecipeId: Guid
    + UserId: Guid
    + Score: int
    + ReviewText: string
    + CookingDate: DateTime
    + WouldMakeAgain: bool
  }

  class NutritionalInfo <<Value Object>> VALUE_OBJECT {
    + Calories: int
    + Protein: decimal
    + Carbohydrates: decimal
    + Fat: decimal
    + Fiber: decimal
    + Allergens: List<string>
  }

  Recipe "1" *-- "*" RecipeIngredient
  Recipe "1" *-- "*" RecipeInstruction
  Recipe "1" *-- "1" NutritionalInfo
  Recipe "1" -- "*" Rating
}

package "Meal Planning" AGGREGATE_ROOT {
  class MealPlan <<Aggregate Root>> {
    + Id: Guid
    + RecipeId: Guid
    + PlannedDate: DateTime
    + MealType: MealType
    + Servings: int
    + Status: MealPlanStatus
    + CreatedBy: Guid
    --
    + Modify()
    + Complete()
    + Cancel()
  }

  class CompletionInfo <<Value Object>> VALUE_OBJECT {
    + ActualServings: int
    + Feedback: string
    + LeftoversAmount: decimal
    + SuccessRating: int
    + CompletedAt: DateTime
  }

  enum MealType {
    Breakfast
    Lunch
    Dinner
    Snack
  }

  enum MealPlanStatus {
    Planned
    InPreparation
    Completed
    Cancelled
  }

  MealPlan "1" *-- "0..1" CompletionInfo
  MealPlan -- MealType
  MealPlan -- MealPlanStatus
  MealPlan "*" -- "1" Recipe
}

package "Grocery & Pantry" AGGREGATE_ROOT {
  class GroceryList <<Aggregate Root>> {
    + Id: Guid
    + GeneratedDate: DateTime
    + EstimatedCost: decimal
    + Status: ShoppingTripStatus
    --
    + AddItem()
    + MarkPurchased()
    + Complete()
  }

  class GroceryItem <<Entity>> ENTITY {
    + Id: Guid
    + Name: string
    + Quantity: decimal
    + Unit: Unit
    + Category: StoreCategory
    + IsPurchased: bool
    + ActualPrice: decimal
  }

  class PantryItem <<Aggregate Root>> {
    + Id: Guid
    + IngredientName: string
    + Quantity: decimal
    + Unit: Unit
    + PurchaseDate: DateTime
    + ExpirationDate: DateTime
    + Location: StorageLocation
    + MinimumThreshold: decimal
    --
    + Use()
    + UpdateQuantity()
  }

  GroceryList "1" *-- "*" GroceryItem
}

package "Household" AGGREGATE_ROOT {
  class HouseholdMember <<Aggregate Root>> {
    + Id: Guid
    + Name: string
    + DateOfBirth: DateTime
    --
    + UpdatePreferences()
    + AddRestriction()
  }

  class DietaryRestriction <<Value Object>> VALUE_OBJECT {
    + IngredientName: string
    + Severity: RestrictionSeverity
    + Reason: string
    + EffectiveDate: DateTime
  }

  class DietaryGoal <<Entity>> ENTITY {
    + Id: Guid
    + Type: GoalType
    + Targets: Dictionary
    + StartDate: DateTime
  }

  HouseholdMember "1" *-- "*" DietaryRestriction
  HouseholdMember "1" -- "*" DietaryGoal
}

package "Leftovers" AGGREGATE_ROOT {
  class LeftoverItem <<Aggregate Root>> {
    + Id: Guid
    + OriginalRecipeId: Guid
    + Quantity: decimal
    + StorageDate: DateTime
    + BestByDate: DateTime
    + Status: LeftoverStatus
    --
    + Consume()
    + Discard()
  }

  LeftoverItem "*" -- "1" Recipe
}

' Relationships across aggregates
MealPlan "*" -- "*" HouseholdMember : "serves"
GroceryList "*" -- "*" Recipe : "generated from"

@enduml
