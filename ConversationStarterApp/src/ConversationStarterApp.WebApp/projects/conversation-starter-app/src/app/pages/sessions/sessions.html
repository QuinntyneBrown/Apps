<div class="sessions">
  <div class="sessions__container">
    <header class="sessions__header">
      <h1 class="sessions__title">Conversation Sessions</h1>
      <p class="sessions__subtitle">Track and manage your conversation sessions</p>
    </header>

    <section class="sessions__list">
      <mat-card class="sessions__card" *ngFor="let session of sessions$ | async">
        <mat-card-header>
          <mat-card-title class="sessions__card-title">
            {{ session.title }}
            <mat-chip class="sessions__status-chip" *ngIf="isActive(session)" color="accent">
              Active
            </mat-chip>
          </mat-card-title>
          <mat-card-subtitle>
            Started: {{ session.startTime | date: 'short' }}
            <span *ngIf="session.endTime"> - Ended: {{ session.endTime | date: 'short' }}</span>
          </mat-card-subtitle>
        </mat-card-header>
        <mat-card-content>
          <div class="sessions__card-details">
            <div class="sessions__card-row" *ngIf="session.duration">
              <mat-icon>timer</mat-icon>
              <span>Duration: {{ session.duration }}</span>
            </div>

            <div class="sessions__card-row" *ngIf="session.participants">
              <mat-icon>people</mat-icon>
              <span>Participants: {{ session.participants }}</span>
            </div>

            <div class="sessions__card-row" *ngIf="session.promptsUsed">
              <mat-icon>chat_bubble</mat-icon>
              <span>Prompts Used: {{ session.promptsUsed }}</span>
            </div>

            <div class="sessions__card-row">
              <mat-icon>{{ session.wasSuccessful ? 'check_circle' : 'cancel' }}</mat-icon>
              <span>{{ session.wasSuccessful ? 'Successful' : 'Not successful' }}</span>
            </div>

            <div class="sessions__card-notes" *ngIf="session.notes">
              <strong>Notes:</strong>
              <p>{{ session.notes }}</p>
            </div>
          </div>
        </mat-card-content>
        <mat-card-actions>
          <button
            mat-button
            color="primary"
            *ngIf="isActive(session)"
            (click)="endSession(session)">
            <mat-icon>stop</mat-icon>
            End Session
          </button>
          <button mat-button color="warn" (click)="deleteSession(session)">
            <mat-icon>delete</mat-icon>
            Delete
          </button>
        </mat-card-actions>
      </mat-card>

      <mat-card class="sessions__empty" *ngIf="(sessions$ | async)?.length === 0">
        <mat-card-content>
          <mat-icon class="sessions__empty-icon">event_note</mat-icon>
          <p>No sessions yet. Start tracking your conversations!</p>
        </mat-card-content>
      </mat-card>
    </section>
  </div>
</div>
