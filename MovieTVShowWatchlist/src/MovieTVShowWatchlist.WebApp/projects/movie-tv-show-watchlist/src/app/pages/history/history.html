<ng-container *ngIf="viewModel$ | async as vm">
  <div class="history">
    <header class="history__header">
      <h1 class="history__title">Viewing History</h1>
    </header>

    <div class="history__list">
      @for (record of vm.records; track record.viewingRecordId) {
        <mat-card class="history__card">
          <div class="history__card-icon">
            {{ record.contentType === 'movie' ? 'ðŸŽ¬' : 'ðŸ“º' }}
          </div>
          <div class="history__card-content">
            <div class="history__card-header">
              <h3 class="history__card-title">{{ record.title }}</h3>
              @if (record.isRewatch) {
                <mat-chip class="history__rewatch-chip">Rewatch</mat-chip>
              }
            </div>
            <div class="history__card-meta">
              <span class="history__card-date">{{ record.watchDate | date:'mediumDate' }}</span>
              <span class="history__card-separator">â€¢</span>
              <span class="history__card-platform">{{ record.platform }}</span>
              <span class="history__card-separator">â€¢</span>
              <span class="history__card-runtime">{{ formatRuntime(record.runtime) }}</span>
            </div>
            @if (record.rating) {
              <div class="history__card-rating">
                {{ getStars(record.rating) }}
              </div>
            }
          </div>
        </mat-card>
      } @empty {
        <div class="history__empty">
          <p>No viewing history yet. Start watching something!</p>
        </div>
      }
    </div>
  </div>
</ng-container>
