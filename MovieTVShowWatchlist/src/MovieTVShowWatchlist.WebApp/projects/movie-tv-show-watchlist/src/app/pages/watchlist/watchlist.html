<ng-container *ngIf="viewModel$ | async as vm">
  <div class="watchlist">
    <mat-sidenav-container class="watchlist__container">
      <mat-sidenav mode="side" opened class="watchlist__sidenav">
        <app-sidebar
          [filter]="vm.filter"
          (filterChange)="onFilterChange($event)"
          (clearFilters)="onClearFilters()"
        ></app-sidebar>
      </mat-sidenav>

      <mat-sidenav-content class="watchlist__content">
        <header class="watchlist__header">
          <h1 class="watchlist__title">
            My Watchlist
            <span class="watchlist__count">({{ vm.itemCount }} items)</span>
          </h1>
          <button mat-flat-button color="primary" class="watchlist__add-btn">
            <mat-icon>add</mat-icon>
            Add Content
          </button>
        </header>

        <div class="watchlist__controls">
          <mat-form-field appearance="outline" class="watchlist__sort">
            <mat-select [value]="vm.sort" (selectionChange)="onSortChange($event.value)">
              @for (option of sortOptions; track option.value) {
                <mat-option [value]="option.value">{{ option.label }}</mat-option>
              }
            </mat-select>
          </mat-form-field>
        </div>

        <div class="watchlist__grid">
          @for (item of vm.items; track item.watchlistItemId) {
            <app-watchlist-card
              [item]="item"
              (watch)="onWatch($event)"
              (remove)="onRemove($event)"
            ></app-watchlist-card>
          } @empty {
            <div class="watchlist__empty">
              <p>No items in your watchlist. Add some content to get started!</p>
            </div>
          }
        </div>
      </mat-sidenav-content>
    </mat-sidenav-container>
  </div>
</ng-container>
