<div class="dashboard" *ngIf="viewModel$ | async as vm">
  <div class="dashboard__header">
    <h1 class="dashboard__title">Dashboard</h1>
  </div>

  <div class="dashboard__stats">
    <mat-card class="dashboard__stat-card">
      <mat-card-header>
        <mat-icon class="dashboard__stat-icon">list</mat-icon>
        <mat-card-title>Watchlist</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="dashboard__stat-number">{{ vm.totalWatchlist }}</div>
        <div class="dashboard__stat-label" *ngIf="vm.highPriorityItems.length > 0">
          {{ vm.highPriorityItems.length }} high priority
        </div>
      </mat-card-content>
      <mat-card-actions>
        <a mat-button routerLink="/watchlist" color="primary">View All</a>
      </mat-card-actions>
    </mat-card>

    <mat-card class="dashboard__stat-card">
      <mat-card-header>
        <mat-icon class="dashboard__stat-icon">favorite</mat-icon>
        <mat-card-title>Favorites</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="dashboard__stat-number">{{ vm.totalFavorites }}</div>
        <div class="dashboard__stat-label">Your favorite content</div>
      </mat-card-content>
      <mat-card-actions>
        <a mat-button routerLink="/favorites" color="primary">View All</a>
      </mat-card-actions>
    </mat-card>

    <mat-card class="dashboard__stat-card">
      <mat-card-header>
        <mat-icon class="dashboard__stat-icon">star</mat-icon>
        <mat-card-title>Ratings</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="dashboard__stat-number">{{ vm.totalRatings }}</div>
        <div class="dashboard__stat-label">Content rated</div>
      </mat-card-content>
      <mat-card-actions>
        <a mat-button routerLink="/ratings" color="primary">View All</a>
      </mat-card-actions>
    </mat-card>

    <mat-card class="dashboard__stat-card">
      <mat-card-header>
        <mat-icon class="dashboard__stat-icon">rate_review</mat-icon>
        <mat-card-title>Reviews</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="dashboard__stat-number">{{ vm.totalReviews }}</div>
        <div class="dashboard__stat-label">Reviews written</div>
      </mat-card-content>
      <mat-card-actions>
        <a mat-button routerLink="/reviews" color="primary">View All</a>
      </mat-card-actions>
    </mat-card>
  </div>

  <div class="dashboard__sections">
    <mat-card class="dashboard__section" *ngIf="vm.highPriorityItems.length > 0">
      <mat-card-header>
        <mat-card-title>High Priority Watchlist</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="dashboard__list">
          <div class="dashboard__list-item" *ngFor="let item of vm.highPriorityItems">
            <div class="dashboard__list-item-content">
              <div class="dashboard__list-item-title">{{ item.title }}</div>
              <div class="dashboard__list-item-subtitle">{{ item.contentType | titlecase }} ({{ item.releaseYear }})</div>
            </div>
            <mat-chip class="dashboard__chip--warning">High Priority</mat-chip>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <mat-card class="dashboard__section" *ngIf="vm.recentViewing.length > 0">
      <mat-card-header>
        <mat-card-title>Recent Viewing History</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="dashboard__list">
          <div class="dashboard__list-item" *ngFor="let record of vm.recentViewing">
            <div class="dashboard__list-item-content">
              <div class="dashboard__list-item-title">{{ record.title }}</div>
              <div class="dashboard__list-item-subtitle">{{ record.watchDate | date:'short' }}</div>
            </div>
            <mat-chip class="dashboard__chip--primary" *ngIf="record.isRewatch">Rewatch</mat-chip>
          </div>
        </div>
      </mat-card-content>
    </mat-card>
  </div>
</div>
