<div class="dashboard" *ngIf="viewModel$ | async as vm">
  <div class="dashboard__header">
    <h1 class="dashboard__title">Dashboard</h1>
  </div>

  <div class="dashboard__stats">
    <mat-card class="dashboard__stat-card">
      <mat-card-header>
        <mat-icon class="dashboard__stat-icon">medical_services</mat-icon>
        <mat-card-title>Screenings</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="dashboard__stat-number">{{ vm.totalScreenings }}</div>
        <div class="dashboard__stat-label" *ngIf="vm.dueSoonScreenings.length > 0">
          {{ vm.dueSoonScreenings.length }} due soon
        </div>
      </mat-card-content>
      <mat-card-actions>
        <a mat-button routerLink="/screenings" color="primary">View All</a>
      </mat-card-actions>
    </mat-card>

    <mat-card class="dashboard__stat-card">
      <mat-card-header>
        <mat-icon class="dashboard__stat-icon">event</mat-icon>
        <mat-card-title>Appointments</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="dashboard__stat-number">{{ vm.totalAppointments }}</div>
        <div class="dashboard__stat-label" *ngIf="vm.upcomingAppointments.length > 0">
          {{ vm.upcomingAppointments.length }} upcoming
        </div>
      </mat-card-content>
      <mat-card-actions>
        <a mat-button routerLink="/appointments" color="primary">View All</a>
      </mat-card-actions>
    </mat-card>

    <mat-card class="dashboard__stat-card">
      <mat-card-header>
        <mat-icon class="dashboard__stat-icon">notifications</mat-icon>
        <mat-card-title>Reminders</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="dashboard__stat-number">{{ vm.totalReminders }}</div>
        <div class="dashboard__stat-label" *ngIf="vm.pendingReminders.length > 0">
          {{ vm.pendingReminders.length }} pending
        </div>
      </mat-card-content>
      <mat-card-actions>
        <a mat-button routerLink="/reminders" color="primary">View All</a>
      </mat-card-actions>
    </mat-card>
  </div>

  <div class="dashboard__sections">
    <mat-card class="dashboard__section" *ngIf="vm.dueSoonScreenings.length > 0">
      <mat-card-header>
        <mat-card-title>Screenings Due Soon</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="dashboard__list">
          <div class="dashboard__list-item" *ngFor="let screening of vm.dueSoonScreenings">
            <div class="dashboard__list-item-content">
              <div class="dashboard__list-item-title">{{ screening.name }}</div>
              <div class="dashboard__list-item-subtitle">Due: {{ screening.nextDueDate | date:'short' }}</div>
            </div>
            <mat-chip class="dashboard__chip--warning">Due Soon</mat-chip>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <mat-card class="dashboard__section" *ngIf="vm.upcomingAppointments.length > 0">
      <mat-card-header>
        <mat-card-title>Upcoming Appointments</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="dashboard__list">
          <div class="dashboard__list-item" *ngFor="let appointment of vm.upcomingAppointments">
            <div class="dashboard__list-item-content">
              <div class="dashboard__list-item-title">{{ appointment.location }}</div>
              <div class="dashboard__list-item-subtitle">{{ appointment.appointmentDate | date:'short' }}</div>
            </div>
            <mat-chip class="dashboard__chip--primary">Upcoming</mat-chip>
          </div>
        </div>
      </mat-card-content>
    </mat-card>
  </div>
</div>
