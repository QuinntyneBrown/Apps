<div class="assignments-list">
  <div class="assignments-list__header">
    <h1 class="assignments-list__title">Assignments</h1>
    <button mat-raised-button color="primary">
      <mat-icon>add</mat-icon>
      Add Assignment
    </button>
  </div>

  <table mat-table [dataSource]="assignments$ | async" class="assignments-list__table">
    <ng-container matColumnDef="choreName">
      <th mat-header-cell *matHeaderCellDef>Chore</th>
      <td mat-cell *matCellDef="let assignment">{{ assignment.choreName }}</td>
    </ng-container>

    <ng-container matColumnDef="familyMemberName">
      <th mat-header-cell *matHeaderCellDef>Assigned To</th>
      <td mat-cell *matCellDef="let assignment">{{ assignment.familyMemberName }}</td>
    </ng-container>

    <ng-container matColumnDef="assignedDate">
      <th mat-header-cell *matHeaderCellDef>Assigned Date</th>
      <td mat-cell *matCellDef="let assignment">{{ assignment.assignedDate | date:'short' }}</td>
    </ng-container>

    <ng-container matColumnDef="dueDate">
      <th mat-header-cell *matHeaderCellDef>Due Date</th>
      <td mat-cell *matCellDef="let assignment">{{ assignment.dueDate | date:'short' }}</td>
    </ng-container>

    <ng-container matColumnDef="status">
      <th mat-header-cell *matHeaderCellDef>Status</th>
      <td mat-cell *matCellDef="let assignment">
        <mat-chip
          [class.assignments-list__chip--completed]="assignment.isCompleted && assignment.isVerified"
          [class.assignments-list__chip--pending]="assignment.isCompleted && !assignment.isVerified"
          [class.assignments-list__chip--overdue]="assignment.isOverdue && !assignment.isCompleted"
          [class.assignments-list__chip--active]="!assignment.isCompleted && !assignment.isOverdue">
          <span *ngIf="assignment.isCompleted && assignment.isVerified">Verified</span>
          <span *ngIf="assignment.isCompleted && !assignment.isVerified">Pending Verification</span>
          <span *ngIf="assignment.isOverdue && !assignment.isCompleted">Overdue</span>
          <span *ngIf="!assignment.isCompleted && !assignment.isOverdue">Active</span>
        </mat-chip>
      </td>
    </ng-container>

    <ng-container matColumnDef="pointsEarned">
      <th mat-header-cell *matHeaderCellDef>Points</th>
      <td mat-cell *matCellDef="let assignment">{{ assignment.pointsEarned }}</td>
    </ng-container>

    <ng-container matColumnDef="actions">
      <th mat-header-cell *matHeaderCellDef>Actions</th>
      <td mat-cell *matCellDef="let assignment">
        <button mat-icon-button color="primary" *ngIf="!assignment.isCompleted" (click)="completeAssignment(assignment.assignmentId)">
          <mat-icon>check_circle</mat-icon>
        </button>
        <button mat-icon-button color="accent" *ngIf="assignment.isCompleted && !assignment.isVerified" (click)="verifyAssignment(assignment.assignmentId, 10)">
          <mat-icon>verified</mat-icon>
        </button>
        <button mat-icon-button color="warn" (click)="deleteAssignment(assignment.assignmentId)">
          <mat-icon>delete</mat-icon>
        </button>
      </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
  </table>
</div>
