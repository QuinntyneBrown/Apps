<div class="trusted-contacts">
  <div class="trusted-contacts__header">
    <div>
      <h1 class="trusted-contacts__title">Trusted Contacts</h1>
      <p class="trusted-contacts__subtitle">Manage your trusted contacts and beneficiaries</p>
    </div>
    <button mat-raised-button color="primary" (click)="openCreateDialog()" class="trusted-contacts__add-btn">
      <mat-icon>add</mat-icon>
      Add Contact
    </button>
  </div>

  <div class="trusted-contacts__list">
    <mat-card *ngFor="let contact of contacts$ | async" class="trusted-contacts__card">
      <mat-card-header class="trusted-contacts__card-header">
        <mat-card-title class="trusted-contacts__card-title">
          {{ contact.fullName }}
          <mat-chip *ngIf="contact.isPrimaryContact" class="trusted-contacts__chip trusted-contacts__chip--primary">
            Primary
          </mat-chip>
        </mat-card-title>
      </mat-card-header>
      <mat-card-content class="trusted-contacts__card-content">
        <div class="trusted-contacts__field">
          <mat-icon class="trusted-contacts__field-icon">family_restroom</mat-icon>
          <span class="trusted-contacts__field-label">Relationship:</span>
          <span class="trusted-contacts__field-value">{{ contact.relationship }}</span>
        </div>
        <div class="trusted-contacts__field">
          <mat-icon class="trusted-contacts__field-icon">email</mat-icon>
          <span class="trusted-contacts__field-label">Email:</span>
          <a [href]="'mailto:' + contact.email" class="trusted-contacts__field-value trusted-contacts__field-value--link">
            {{ contact.email }}
          </a>
        </div>
        <div class="trusted-contacts__field" *ngIf="contact.phoneNumber">
          <mat-icon class="trusted-contacts__field-icon">phone</mat-icon>
          <span class="trusted-contacts__field-label">Phone:</span>
          <a [href]="'tel:' + contact.phoneNumber" class="trusted-contacts__field-value trusted-contacts__field-value--link">
            {{ contact.phoneNumber }}
          </a>
        </div>
        <div class="trusted-contacts__field" *ngIf="contact.role">
          <mat-icon class="trusted-contacts__field-icon">work</mat-icon>
          <span class="trusted-contacts__field-label">Role:</span>
          <span class="trusted-contacts__field-value">{{ contact.role }}</span>
        </div>
        <div class="trusted-contacts__field">
          <mat-icon class="trusted-contacts__field-icon">notifications</mat-icon>
          <span class="trusted-contacts__field-label">Notified:</span>
          <span class="trusted-contacts__field-value">{{ contact.isNotified ? 'Yes' : 'No' }}</span>
        </div>
        <div class="trusted-contacts__field" *ngIf="contact.notes">
          <mat-icon class="trusted-contacts__field-icon">note</mat-icon>
          <span class="trusted-contacts__field-label">Notes:</span>
          <span class="trusted-contacts__field-value">{{ contact.notes }}</span>
        </div>
      </mat-card-content>
      <mat-card-actions class="trusted-contacts__card-actions">
        <button mat-button color="primary" (click)="openEditDialog(contact)">
          <mat-icon>edit</mat-icon>
          Edit
        </button>
        <button mat-button color="warn" (click)="deleteContact(contact)">
          <mat-icon>delete</mat-icon>
          Delete
        </button>
      </mat-card-actions>
    </mat-card>

    <div *ngIf="(contacts$ | async)?.length === 0" class="trusted-contacts__empty">
      <mat-icon class="trusted-contacts__empty-icon">contacts</mat-icon>
      <p class="trusted-contacts__empty-text">No trusted contacts yet</p>
      <button mat-raised-button color="primary" (click)="openCreateDialog()">
        Add Your First Contact
      </button>
    </div>
  </div>
</div>
