<div class="dashboard">
  <div class="dashboard__header">
    <h1 class="dashboard__title">Dashboard</h1>
    <p class="dashboard__subtitle">Welcome to PetCareManager</p>
  </div>

  <ng-container *ngIf="stats$ | async as stats">
    <div class="dashboard__stats">
      <mat-card class="dashboard__stat-card">
        <mat-card-content>
          <div class="dashboard__stat">
            <mat-icon class="dashboard__stat-icon" color="primary">pets</mat-icon>
            <div class="dashboard__stat-info">
              <span class="dashboard__stat-value">{{ stats.totalPets }}</span>
              <span class="dashboard__stat-label">Total Pets</span>
            </div>
          </div>
        </mat-card-content>
      </mat-card>

      <mat-card class="dashboard__stat-card">
        <mat-card-content>
          <div class="dashboard__stat">
            <mat-icon class="dashboard__stat-icon" color="accent">event</mat-icon>
            <div class="dashboard__stat-info">
              <span class="dashboard__stat-value">{{ stats.upcomingAppointments }}</span>
              <span class="dashboard__stat-label">Upcoming Appointments</span>
            </div>
          </div>
        </mat-card-content>
      </mat-card>

      <mat-card class="dashboard__stat-card">
        <mat-card-content>
          <div class="dashboard__stat">
            <mat-icon class="dashboard__stat-icon" color="warn">medication</mat-icon>
            <div class="dashboard__stat-info">
              <span class="dashboard__stat-value">{{ stats.activeMedications }}</span>
              <span class="dashboard__stat-label">Active Medications</span>
            </div>
          </div>
        </mat-card-content>
      </mat-card>
    </div>
  </ng-container>

  <div class="dashboard__sections">
    <mat-card class="dashboard__section">
      <mat-card-header>
        <mat-card-title>Recent Pets</mat-card-title>
        <button mat-button color="primary" routerLink="/pets">View All</button>
      </mat-card-header>
      <mat-card-content>
        <ng-container *ngIf="recentPets$ | async as pets">
          <div class="dashboard__pets" *ngIf="pets.length > 0; else noPets">
            <div class="dashboard__pet" *ngFor="let pet of pets">
              <mat-icon>{{ pet.petType.toLowerCase() }}</mat-icon>
              <div class="dashboard__pet-info">
                <span class="dashboard__pet-name">{{ pet.name }}</span>
                <span class="dashboard__pet-breed">{{ pet.breed || pet.petType }}</span>
              </div>
              <button mat-icon-button [routerLink]="['/pets', pet.petId]">
                <mat-icon>arrow_forward</mat-icon>
              </button>
            </div>
          </div>
          <ng-template #noPets>
            <p class="dashboard__empty">No pets yet. Add your first pet!</p>
          </ng-template>
        </ng-container>
      </mat-card-content>
    </mat-card>

    <mat-card class="dashboard__section">
      <mat-card-header>
        <mat-card-title>Upcoming Appointments</mat-card-title>
        <button mat-button color="primary" routerLink="/appointments">View All</button>
      </mat-card-header>
      <mat-card-content>
        <ng-container *ngIf="upcomingAppointments$ | async as appointments">
          <div class="dashboard__appointments" *ngIf="appointments.length > 0; else noAppointments">
            <div class="dashboard__appointment" *ngFor="let appointment of appointments">
              <mat-icon>event</mat-icon>
              <div class="dashboard__appointment-info">
                <span class="dashboard__appointment-reason">{{ appointment.reason || 'Veterinary Visit' }}</span>
                <span class="dashboard__appointment-date">{{ appointment.appointmentDate | date: 'medium' }}</span>
              </div>
            </div>
          </div>
          <ng-template #noAppointments>
            <p class="dashboard__empty">No upcoming appointments.</p>
          </ng-template>
        </ng-container>
      </mat-card-content>
    </mat-card>
  </div>

  <div class="dashboard__actions">
    <button mat-raised-button color="primary" routerLink="/pets">
      <mat-icon>add</mat-icon>
      Add Pet
    </button>
    <button mat-raised-button color="accent" routerLink="/appointments">
      <mat-icon>add</mat-icon>
      Schedule Appointment
    </button>
  </div>
</div>
