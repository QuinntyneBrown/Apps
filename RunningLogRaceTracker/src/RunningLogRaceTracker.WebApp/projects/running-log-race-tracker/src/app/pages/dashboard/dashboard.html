<div class="dashboard" *ngIf="dashboardData$ | async as data">
  <div class="dashboard__container">
    <h1 class="dashboard__title">Dashboard</h1>

    <div class="dashboard__stats">
      <mat-card class="dashboard__stat-card">
        <mat-card-content>
          <div class="dashboard__stat-icon">
            <mat-icon>directions_run</mat-icon>
          </div>
          <div class="dashboard__stat-value">{{ data.totalRuns }}</div>
          <div class="dashboard__stat-label">Total Runs</div>
        </mat-card-content>
      </mat-card>

      <mat-card class="dashboard__stat-card">
        <mat-card-content>
          <div class="dashboard__stat-icon">
            <mat-icon>straighten</mat-icon>
          </div>
          <div class="dashboard__stat-value">{{ data.totalDistance }}</div>
          <div class="dashboard__stat-label">Total Distance (km)</div>
        </mat-card-content>
      </mat-card>

      <mat-card class="dashboard__stat-card">
        <mat-card-content>
          <div class="dashboard__stat-icon">
            <mat-icon>event</mat-icon>
          </div>
          <div class="dashboard__stat-value">{{ data.upcomingRaces }}</div>
          <div class="dashboard__stat-label">Upcoming Races</div>
        </mat-card-content>
      </mat-card>

      <mat-card class="dashboard__stat-card">
        <mat-card-content>
          <div class="dashboard__stat-icon">
            <mat-icon>calendar_today</mat-icon>
          </div>
          <div class="dashboard__stat-value">{{ data.activePlans }}</div>
          <div class="dashboard__stat-label">Active Plans</div>
        </mat-card-content>
      </mat-card>
    </div>

    <div class="dashboard__sections">
      <mat-card class="dashboard__section">
        <mat-card-header>
          <mat-card-title>Recent Runs</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div *ngIf="data.recentRuns.length === 0" class="dashboard__empty">
            No runs yet. Start tracking your runs!
          </div>
          <div *ngFor="let run of data.recentRuns" class="dashboard__item">
            <div>
              <div class="dashboard__item-title">{{ run.distance }} km</div>
              <div class="dashboard__item-subtitle">{{ run.completedAt | date:'short' }}</div>
            </div>
            <div class="dashboard__item-meta">
              {{ run.durationMinutes }} min
            </div>
          </div>
        </mat-card-content>
        <mat-card-actions>
          <a mat-button routerLink="/runs">View All Runs</a>
        </mat-card-actions>
      </mat-card>

      <mat-card class="dashboard__section">
        <mat-card-header>
          <mat-card-title>Upcoming Races</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div *ngIf="data.upcomingRacesList.length === 0" class="dashboard__empty">
            No upcoming races. Register for a race!
          </div>
          <div *ngFor="let race of data.upcomingRacesList" class="dashboard__item">
            <div>
              <div class="dashboard__item-title">{{ race.name }}</div>
              <div class="dashboard__item-subtitle">{{ race.raceDate | date:'mediumDate' }}</div>
            </div>
            <div class="dashboard__item-meta">
              {{ race.distance }} km
            </div>
          </div>
        </mat-card-content>
        <mat-card-actions>
          <a mat-button routerLink="/races">View All Races</a>
        </mat-card-actions>
      </mat-card>
    </div>
  </div>
</div>
