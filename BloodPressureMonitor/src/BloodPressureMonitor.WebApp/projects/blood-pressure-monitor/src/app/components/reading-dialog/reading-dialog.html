<h2 mat-dialog-title class="reading-dialog__title">
  {{ isEditMode ? 'Edit Reading' : 'Add New Reading' }}
</h2>

<mat-dialog-content class="reading-dialog__content">
  <form [formGroup]="readingForm" class="reading-dialog__form">
    <div class="reading-dialog__row">
      <mat-form-field appearance="outline" class="reading-dialog__field">
        <mat-label>Systolic (mmHg)</mat-label>
        <input
          matInput
          type="number"
          formControlName="systolic"
          placeholder="120"
        />
        @if (readingForm.get('systolic')?.hasError('required')) {
          <mat-error>Systolic pressure is required</mat-error>
        }
        @if (readingForm.get('systolic')?.hasError('min')) {
          <mat-error>Minimum value is 70</mat-error>
        }
        @if (readingForm.get('systolic')?.hasError('max')) {
          <mat-error>Maximum value is 250</mat-error>
        }
      </mat-form-field>

      <mat-form-field appearance="outline" class="reading-dialog__field">
        <mat-label>Diastolic (mmHg)</mat-label>
        <input
          matInput
          type="number"
          formControlName="diastolic"
          placeholder="80"
        />
        @if (readingForm.get('diastolic')?.hasError('required')) {
          <mat-error>Diastolic pressure is required</mat-error>
        }
        @if (readingForm.get('diastolic')?.hasError('min')) {
          <mat-error>Minimum value is 40</mat-error>
        }
        @if (readingForm.get('diastolic')?.hasError('max')) {
          <mat-error>Maximum value is 150</mat-error>
        }
      </mat-form-field>
    </div>

    <div class="reading-dialog__row">
      <mat-form-field appearance="outline" class="reading-dialog__field">
        <mat-label>Pulse (bpm)</mat-label>
        <input
          matInput
          type="number"
          formControlName="pulse"
          placeholder="70"
        />
        @if (readingForm.get('pulse')?.hasError('min')) {
          <mat-error>Minimum value is 40</mat-error>
        }
        @if (readingForm.get('pulse')?.hasError('max')) {
          <mat-error>Maximum value is 200</mat-error>
        }
      </mat-form-field>

      <mat-form-field appearance="outline" class="reading-dialog__field">
        <mat-label>Measured At</mat-label>
        <input
          matInput
          [matDatepicker]="picker"
          formControlName="measuredAt"
        />
        <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
        <mat-datepicker #picker></mat-datepicker>
        @if (readingForm.get('measuredAt')?.hasError('required')) {
          <mat-error>Date is required</mat-error>
        }
      </mat-form-field>
    </div>

    <div class="reading-dialog__row">
      <mat-form-field appearance="outline" class="reading-dialog__field">
        <mat-label>Position</mat-label>
        <mat-select formControlName="position">
          <mat-option value="">None</mat-option>
          @for (position of positions; track position) {
            <mat-option [value]="position">{{ position }}</mat-option>
          }
        </mat-select>
      </mat-form-field>

      <mat-form-field appearance="outline" class="reading-dialog__field">
        <mat-label>Arm</mat-label>
        <mat-select formControlName="arm">
          <mat-option value="">None</mat-option>
          @for (arm of arms; track arm) {
            <mat-option [value]="arm">{{ arm }}</mat-option>
          }
        </mat-select>
      </mat-form-field>
    </div>

    <mat-form-field appearance="outline" class="reading-dialog__field reading-dialog__field--full">
      <mat-label>Notes</mat-label>
      <textarea
        matInput
        formControlName="notes"
        rows="3"
        placeholder="Add any relevant notes..."
      ></textarea>
    </mat-form-field>
  </form>
</mat-dialog-content>

<mat-dialog-actions class="reading-dialog__actions">
  <button mat-button (click)="onCancel()">Cancel</button>
  <button
    mat-raised-button
    color="primary"
    (click)="onSubmit()"
    [disabled]="!readingForm.valid"
  >
    {{ isEditMode ? 'Update' : 'Add' }}
  </button>
</mat-dialog-actions>
