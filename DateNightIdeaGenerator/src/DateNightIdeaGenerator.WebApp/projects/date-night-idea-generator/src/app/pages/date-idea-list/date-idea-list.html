<div class="date-idea-list">
  <div class="date-idea-list__header">
    <h1 class="date-idea-list__title">Date Ideas</h1>
    <button mat-raised-button color="primary" routerLink="/date-ideas/new">
      <mat-icon>add</mat-icon>
      New Date Idea
    </button>
  </div>

  <div class="date-idea-list__filters">
    <mat-form-field appearance="outline">
      <mat-label>Category</mat-label>
      <mat-select [(ngModel)]="selectedCategory" (selectionChange)="loadDateIdeas()">
        <mat-option [value]="undefined">All Categories</mat-option>
        <mat-option *ngFor="let category of categories" [value]="category">
          {{ category }}
        </mat-option>
      </mat-select>
    </mat-form-field>

    <mat-form-field appearance="outline">
      <mat-label>Budget Range</mat-label>
      <mat-select [(ngModel)]="selectedBudgetRange" (selectionChange)="loadDateIdeas()">
        <mat-option [value]="undefined">All Budgets</mat-option>
        <mat-option *ngFor="let budget of budgetRanges" [value]="budget">
          {{ budget }}
        </mat-option>
      </mat-select>
    </mat-form-field>

    <button mat-stroked-button [color]="showFavoritesOnly ? 'accent' : ''" (click)="showFavoritesOnly = !showFavoritesOnly; loadDateIdeas()">
      <mat-icon>{{ showFavoritesOnly ? 'favorite' : 'favorite_border' }}</mat-icon>
      Favorites Only
    </button>
  </div>

  <div class="date-idea-list__grid">
    <mat-card *ngFor="let idea of dateIdeas$ | async" class="date-idea-list__card">
      <mat-card-header>
        <mat-card-title>{{ idea.title }}</mat-card-title>
        <mat-card-subtitle>{{ getCategoryName(idea.category) }} - {{ getBudgetRangeName(idea.budgetRange) }}</mat-card-subtitle>
      </mat-card-header>
      <mat-card-content>
        <p class="date-idea-list__description">{{ idea.description }}</p>
        <div class="date-idea-list__meta">
          <mat-chip-set>
            <mat-chip *ngIf="idea.location">
              <mat-icon>location_on</mat-icon>
              {{ idea.location }}
            </mat-chip>
            <mat-chip *ngIf="idea.durationMinutes">
              <mat-icon>schedule</mat-icon>
              {{ idea.durationMinutes }} min
            </mat-chip>
            <mat-chip *ngIf="idea.season">
              <mat-icon>wb_sunny</mat-icon>
              {{ idea.season }}
            </mat-chip>
            <mat-chip *ngIf="idea.averageRating" color="accent">
              <mat-icon>star</mat-icon>
              {{ idea.averageRating.toFixed(1) }}
            </mat-chip>
          </mat-chip-set>
        </div>
      </mat-card-content>
      <mat-card-actions>
        <button mat-button [routerLink]="['/date-ideas', idea.dateIdeaId]">
          <mat-icon>visibility</mat-icon>
          View
        </button>
        <button mat-button (click)="toggleFavorite(idea)">
          <mat-icon>{{ idea.isFavorite ? 'favorite' : 'favorite_border' }}</mat-icon>
          {{ idea.isFavorite ? 'Unfavorite' : 'Favorite' }}
        </button>
        <button mat-button color="warn" (click)="delete(idea.dateIdeaId)">
          <mat-icon>delete</mat-icon>
          Delete
        </button>
      </mat-card-actions>
    </mat-card>
  </div>

  <div *ngIf="(dateIdeas$ | async)?.length === 0" class="date-idea-list__empty">
    <mat-icon>lightbulb_outline</mat-icon>
    <p>No date ideas found. Create your first one!</p>
    <button mat-raised-button color="primary" routerLink="/date-ideas/new">
      Create Date Idea
    </button>
  </div>
</div>
