<div class="projection-list">
  <div class="projection-list__header">
    <h1 class="projection-list__title">Projections</h1>
  </div>

  <div class="projection-list__grid">
    <mat-card *ngFor="let projection of projections$ | async" class="projection-list__card">
      <mat-card-header>
        <mat-icon mat-card-avatar class="projection-list__card-icon">trending_up</mat-icon>
        <mat-card-title>{{ projection.name }}</mat-card-title>
        <mat-card-subtitle>{{ projection.yearsUntilCollege }} years until college</mat-card-subtitle>
      </mat-card-header>
      <mat-card-content>
        <div class="projection-list__card-info">
          <div class="projection-list__card-info-item">
            <span class="projection-list__card-info-label">Projected Balance:</span>
            <span class="projection-list__card-info-value">{{ projection.projectedBalance | currency }}</span>
          </div>
          <div class="projection-list__card-info-item">
            <span class="projection-list__card-info-label">Target Goal:</span>
            <span class="projection-list__card-info-value">{{ projection.targetGoal | currency }}</span>
          </div>
          <div class="projection-list__card-info-item">
            <span class="projection-list__card-info-label">Goal Difference:</span>
            <span class="projection-list__card-info-value"
                  [class.projection-list__positive]="projection.goalDifference >= 0"
                  [class.projection-list__negative]="projection.goalDifference < 0">
              {{ projection.goalDifference | currency }}
            </span>
          </div>
        </div>
        <div class="projection-list__progress">
          <div class="projection-list__progress-header">
            <span class="projection-list__progress-label">Progress</span>
            <span class="projection-list__progress-value">{{ getProgressPercentage(projection) | number:'1.0-0' }}%</span>
          </div>
          <mat-progress-bar
            mode="determinate"
            [value]="getProgressPercentage(projection)"
            class="projection-list__progress-bar">
          </mat-progress-bar>
        </div>
      </mat-card-content>
      <mat-card-actions>
        <button mat-button color="primary" [routerLink]="['/projections', projection.projectionId]">
          <mat-icon>visibility</mat-icon>
          View Details
        </button>
        <button mat-button color="warn" (click)="deleteProjection(projection.projectionId)">
          <mat-icon>delete</mat-icon>
          Delete
        </button>
      </mat-card-actions>
    </mat-card>

    <div *ngIf="(projections$ | async)?.length === 0" class="projection-list__empty">
      <mat-icon class="projection-list__empty-icon">trending_up</mat-icon>
      <p>No projections found</p>
      <p class="projection-list__empty-subtitle">Create your first projection to plan for college expenses</p>
    </div>
  </div>
</div>
