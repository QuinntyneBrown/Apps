<div class="projection-detail" *ngIf="projection$ | async as projection">
  <div class="projection-detail__header">
    <button mat-icon-button routerLink="/projections" class="projection-detail__back">
      <mat-icon>arrow_back</mat-icon>
    </button>
    <h1 class="projection-detail__title">{{ projection.name }}</h1>
    <span class="projection-detail__spacer"></span>
    <button mat-raised-button color="warn" (click)="deleteProjection()">
      <mat-icon>delete</mat-icon>
      Delete Projection
    </button>
  </div>

  <div class="projection-detail__cards">
    <mat-card class="projection-detail__card">
      <mat-card-header>
        <mat-card-title>Current Status</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="projection-detail__progress">
          <div class="projection-detail__progress-header">
            <span class="projection-detail__progress-label">Progress to Goal</span>
            <span class="projection-detail__progress-value">{{ getProgressPercentage(projection) | number:'1.0-0' }}%</span>
          </div>
          <mat-progress-bar
            mode="determinate"
            [value]="getProgressPercentage(projection)"
            class="projection-detail__progress-bar">
          </mat-progress-bar>
          <div class="projection-detail__progress-details">
            <span>{{ projection.projectedBalance | currency }}</span>
            <span>of {{ projection.targetGoal | currency }}</span>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <mat-card class="projection-detail__card">
      <mat-card-header>
        <mat-card-title>Projection Details</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="projection-detail__info-grid">
          <div class="projection-detail__info-item">
            <span class="projection-detail__info-label">Current Savings:</span>
            <span class="projection-detail__info-value">{{ projection.currentSavings | currency }}</span>
          </div>
          <div class="projection-detail__info-item">
            <span class="projection-detail__info-label">Monthly Contribution:</span>
            <span class="projection-detail__info-value">{{ projection.monthlyContribution | currency }}</span>
          </div>
          <div class="projection-detail__info-item">
            <span class="projection-detail__info-label">Expected Return Rate:</span>
            <span class="projection-detail__info-value">{{ projection.expectedReturnRate | number:'1.2-2' }}%</span>
          </div>
          <div class="projection-detail__info-item">
            <span class="projection-detail__info-label">Years Until College:</span>
            <span class="projection-detail__info-value">{{ projection.yearsUntilCollege }}</span>
          </div>
          <div class="projection-detail__info-item">
            <span class="projection-detail__info-label">Target Goal:</span>
            <span class="projection-detail__info-value">{{ projection.targetGoal | currency }}</span>
          </div>
          <div class="projection-detail__info-item">
            <span class="projection-detail__info-label">Projected Balance:</span>
            <span class="projection-detail__info-value">{{ projection.projectedBalance | currency }}</span>
          </div>
          <div class="projection-detail__info-item">
            <span class="projection-detail__info-label">Goal Difference:</span>
            <span class="projection-detail__info-value"
                  [class.projection-detail__info-value--positive]="projection.goalDifference >= 0"
                  [class.projection-detail__info-value--negative]="projection.goalDifference < 0">
              {{ projection.goalDifference | currency }}
            </span>
          </div>
          <div class="projection-detail__info-item">
            <span class="projection-detail__info-label">Required Monthly Contribution:</span>
            <span class="projection-detail__info-value">{{ projection.requiredMonthlyContribution | currency }}</span>
          </div>
          <div class="projection-detail__info-item">
            <span class="projection-detail__info-label">Created At:</span>
            <span class="projection-detail__info-value">{{ projection.createdAt | date:'medium' }}</span>
          </div>
        </div>
      </mat-card-content>
    </mat-card>
  </div>
</div>
