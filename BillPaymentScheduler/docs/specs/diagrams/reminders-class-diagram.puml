@startuml Reminders Class Diagram


class Reminder <<Aggregate Root>> {
  - reminderId: Guid
  - billId: Guid
  - userId: Guid
  - reminderType: ReminderType
  - daysBefore: int
  - notificationChannels: List<NotificationChannel>
  - isActive: bool
  - lastSentAt: DateTime?
  - nextScheduledAt: DateTime?
  --
  + Send(): void
  + UpdateSchedule(): void
  + Deactivate(): void
}

enum ReminderType {
  UpcomingPayment
  DueSoon
  Overdue
  PaymentConfirmation
}

enum NotificationChannel {
  Email
  SMS
  Push
}

class NotificationLog <<Entity>> {
  - notificationLogId: Guid
  - reminderId: Guid
  - channel: NotificationChannel
  - sentAt: DateTime
  - status: DeliveryStatus
  - recipientAddress: string
  - messageContent: string
  - errorMessage: string?
}

enum DeliveryStatus {
  Sent
  Delivered
  Failed
  Bounced
}

class CreateReminderCommand {
  + BillId: Guid
  + TenantId: Guid
  + UserId: Guid
  + ReminderType: ReminderType
  + DaysBefore: int
  + NotificationChannels: List<NotificationChannel>
}

class SendReminderCommand {
  + ReminderId: Guid
  + TenantId: Guid
}

class PaymentReminderSent <<Domain Event>> {
  + ReminderId: Guid
  + BillId: Guid
  + UserId: Guid
  + Payee: string
  + Amount: decimal
  + DueDate: DateTime
  + Channels: List<string>
  + SentAt: DateTime
  + OccurredAt: DateTime
}

class LatePaymentWarning <<Domain Event>> {
  + BillId: Guid
  + UserId: Guid
  + Payee: string
  + Amount: decimal
  + DueDate: DateTime
  + DaysOverdue: int
  + OccurredAt: DateTime
}

interface INotificationService {
  + SendEmailAsync(to, subject, body): Task<NotificationResult>
  + SendSMSAsync(phoneNumber, message): Task<NotificationResult>
  + SendPushNotificationAsync(userId, title, body): Task<NotificationResult>
}

Reminder *-- ReminderType
Reminder *-- NotificationChannel
NotificationLog *-- NotificationChannel
NotificationLog *-- DeliveryStatus

@enduml
