<div class="page-container">
  <div class="purchases__header">
    <h1 class="page-title">Purchases</h1>
  </div>

  @if (viewModel$ | async; as vm) {
    <div class="purchases__summary">
      <div class="purchases__summary-item">
        <mat-icon>shopping_cart</mat-icon>
        <span>{{ vm.purchaseCount }} purchases</span>
      </div>
      <div class="purchases__summary-item purchases__summary-item--total">
        <mat-icon>attach_money</mat-icon>
        <span>Total: ${{ vm.totalSpent.toFixed(2) }}</span>
      </div>
    </div>

    @if (vm.purchases.length > 0) {
      <div class="card-grid">
        @for (purchase of vm.purchases; track purchase.purchaseId) {
          <app-purchase-card
            [purchase]="purchase"
            [giftIdea]="getGiftIdea(purchase.giftIdeaId, vm.giftIdeasMap)"
            (deleteClick)="onDeletePurchase($event)">
          </app-purchase-card>
        }
      </div>
    } @else {
      <div class="purchases__empty">
        <mat-icon>shopping_cart</mat-icon>
        <p>No purchases yet. Purchase a gift idea to see it here!</p>
      </div>
    }
  }
</div>
