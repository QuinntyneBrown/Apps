<div class="value-estimates">
  <div class="value-estimates__container">
    <div class="value-estimates__header">
      <h1 class="value-estimates__title">Value Estimates</h1>
      <button mat-raised-button color="primary" class="value-estimates__add-button" (click)="onAddValueEstimate()">
        <mat-icon>add</mat-icon>
        Add Value Estimate
      </button>
    </div>

    <div class="value-estimates__filters">
      <mat-form-field appearance="outline" class="value-estimates__filter">
        <mat-label>Filter by Item</mat-label>
        <mat-select [(value)]="selectedItemId" (selectionChange)="onItemFilterChange($event.value)">
          <mat-option [value]="null">All Items</mat-option>
          <mat-option *ngFor="let item of items" [value]="item.itemId">
            {{ item.name }}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>

    <div class="value-estimates__content" *ngIf="!(loading$ | async); else loadingTemplate">
      <div class="value-estimates__grid" *ngIf="(valueEstimates$ | async)?.length ?? 0 > 0; else emptyTemplate">
        <div class="value-estimates__item" *ngFor="let estimate of valueEstimates$ | async">
          <div class="value-estimates__item-header">
            <span class="value-estimates__item-name">{{ getItemName(estimate.itemId) }}</span>
          </div>
          <app-value-estimate-card
            [estimate]="estimate"
            (edit)="onEditValueEstimate($event)"
            (delete)="onDeleteValueEstimate($event)"
          ></app-value-estimate-card>
        </div>
      </div>

      <ng-template #emptyTemplate>
        <div class="value-estimates__empty">
          <mat-icon>assessment</mat-icon>
          <h2>No value estimates found</h2>
          <p>Add value estimates to track the worth of your items over time.</p>
          <button mat-raised-button color="primary" (click)="onAddValueEstimate()">
            <mat-icon>add</mat-icon>
            Add Your First Value Estimate
          </button>
        </div>
      </ng-template>
    </div>

    <ng-template #loadingTemplate>
      <div class="value-estimates__loading">
        <mat-spinner></mat-spinner>
      </div>
    </ng-template>
  </div>
</div>
