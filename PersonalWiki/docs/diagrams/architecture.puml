@startuml PersonalWiki_Architecture
skinparam componentStyle rectangle

package "Frontend" {
    component [Wiki Editor] as Editor
    component [Page Viewer] as Viewer
    component [Search UI] as Search
    component [Graph Visualization] as Graph
}

package "API Layer" {
    component [API Gateway] as Gateway
    component [Auth Service] as Auth
}

package "Business Logic" {
    component [Page Service] as PageSvc
    component [Link Service] as LinkSvc
    component [Version Service] as VersionSvc
    component [Search Service] as SearchSvc
    component [Template Service] as TemplateSvc
}

package "Data Layer" {
    database [PostgreSQL] as DB
    database [Elasticsearch] as ES
    database [Neo4j Graph] as GraphDB
    component [File Storage] as FileStore
    component [Event Store] as Events
}

Editor --> Gateway
Viewer --> Gateway
Search --> Gateway
Graph --> Gateway

Gateway --> Auth
Gateway --> PageSvc
Gateway --> LinkSvc
Gateway --> VersionSvc
Gateway --> SearchSvc

PageSvc --> DB
PageSvc --> Events
LinkSvc --> GraphDB
LinkSvc --> Events
VersionSvc --> DB
SearchSvc --> ES
TemplateSvc --> DB

PageSvc --> SearchSvc : Index pages
LinkSvc --> PageSvc : Update backlinks

@enduml
