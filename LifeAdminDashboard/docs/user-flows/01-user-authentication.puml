@startuml User Authentication Flow
title User Authentication Flow - LifeAdminDashboard

actor User
participant "Login Page" as Login
participant "Auth Service" as AuthService
participant "API Gateway" as API
participant "Auth Controller" as Controller
participant "ILifeAdminDashboardContext" as Context
participant "Database" as DB

User -> Login: Enter credentials
Login -> Login: Validate form fields
Login -> AuthService: login(username, password)
AuthService -> API: POST /api/auth/login
API -> Controller: Authenticate request
Controller -> Context: Users.FirstOrDefaultAsync(u => u.Username == username)
Context -> DB: SELECT * FROM Users WHERE Username = @username
DB --> Context: User record
Context --> Controller: User entity
Controller -> Controller: Verify password hash (PBKDF2)

alt Valid Credentials
    Controller -> Controller: Generate JWT token
    Controller --> API: 200 OK + JWT token
    API --> AuthService: Token response
    AuthService -> AuthService: Store token in localStorage
    AuthService --> Login: Success
    Login -> User: Redirect to Dashboard
else Invalid Credentials
    Controller --> API: 401 Unauthorized
    API --> AuthService: Error response
    AuthService --> Login: Auth failed
    Login -> User: Show error message
end

@enduml
