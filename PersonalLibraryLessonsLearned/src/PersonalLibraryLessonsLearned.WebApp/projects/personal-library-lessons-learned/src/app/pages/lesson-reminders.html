<div class="reminders">
  <div class="reminders__header">
    <h1 class="reminders__title">Lesson Reminders</h1>
    <button mat-raised-button color="primary" (click)="openDialog()">
      <mat-icon>add</mat-icon>
      New Reminder
    </button>
  </div>

  <mat-card class="reminders__card">
    @if (loading$ | async) {
      <div class="reminders__loading">Loading...</div>
    } @else {
      <table mat-table [dataSource]="(reminders$ | async) || []" class="reminders__table">
        <ng-container matColumnDef="lesson">
          <th mat-header-cell *matHeaderCellDef>Lesson</th>
          <td mat-cell *matCellDef="let reminder">{{ getLessonTitle(reminder.lessonId) }}</td>
        </ng-container>

        <ng-container matColumnDef="reminderDateTime">
          <th mat-header-cell *matHeaderCellDef>Reminder Date & Time</th>
          <td mat-cell *matCellDef="let reminder">{{ reminder.reminderDateTime | date:'medium' }}</td>
        </ng-container>

        <ng-container matColumnDef="isSent">
          <th mat-header-cell *matHeaderCellDef>Sent</th>
          <td mat-cell *matCellDef="let reminder">
            <mat-icon [class.reminders__sent]="reminder.isSent">
              {{ reminder.isSent ? 'check_circle' : 'cancel' }}
            </mat-icon>
          </td>
        </ng-container>

        <ng-container matColumnDef="isDismissed">
          <th mat-header-cell *matHeaderCellDef>Dismissed</th>
          <td mat-cell *matCellDef="let reminder">
            <mat-icon [class.reminders__dismissed]="reminder.isDismissed">
              {{ reminder.isDismissed ? 'check_circle' : 'cancel' }}
            </mat-icon>
          </td>
        </ng-container>

        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef>Actions</th>
          <td mat-cell *matCellDef="let reminder">
            <button mat-icon-button color="primary" (click)="openDialog(reminder)">
              <mat-icon>edit</mat-icon>
            </button>
            <button mat-icon-button color="warn" (click)="deleteReminder(reminder)">
              <mat-icon>delete</mat-icon>
            </button>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
      </table>

      @if ((reminders$ | async)?.length === 0) {
        <div class="reminders__empty">
          <p>No reminders found. Create your first reminder to get started!</p>
        </div>
      }
    }
  </mat-card>
</div>
