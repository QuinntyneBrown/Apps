@startuml Exercises - Class Diagram

!define ENTITY_COLOR #E8F4F8
!define VALUE_OBJECT_COLOR #FFF4E6
!define ENUM_COLOR #F0F0F0

skinparam class {
    BackgroundColor<<Entity>> ENTITY_COLOR
    BackgroundColor<<AggregateRoot>> #D4E6F1
    BackgroundColor<<ValueObject>> VALUE_OBJECT_COLOR
    BackgroundColor<<Enum>> ENUM_COLOR
    BorderColor #2C3E50
    ArrowColor #34495E
}

package "Exercises Aggregate" {
    class Exercise <<AggregateRoot>> {
        - Id : Guid
        - Name : string
        - Description : string
        - Category : ExerciseCategory
        - PrimaryMuscleGroup : MuscleGroup
        - SecondaryMuscleGroups : List<MuscleGroup>
        - Equipment : EquipmentType
        - Difficulty : DifficultyLevel
        - Instructions : string
        - VideoUrl : string
        - ImageUrl : string
        - IsCustom : bool
        - CreatedByUserId : Guid?
        - CreatedDate : DateTime
        - IsApproved : bool
        - PopularityScore : int
        --
        + UpdateDetails(name, description, instructions) : void
        + SetMediaUrls(videoUrl, imageUrl) : void
        + Approve() : void
        + IncrementPopularity() : void
    }
}

package "Performance Tracking" {
    class ExercisePerformance <<Entity>> {
        - Id : Guid
        - ExerciseId : Guid
        - UserId : Guid
        - WorkoutSessionId : Guid
        - PerformedDate : DateTime
        - TotalSets : int
        - TotalReps : int
        - MaxWeight : decimal
        - WeightUnit : WeightUnit
        - TotalVolume : decimal
        - Duration : TimeSpan?
        - Notes : string
        - Sets : List<SetPerformance>
        --
        + CalculateTotalVolume() : decimal
        + EstimateOneRepMax() : decimal
    }

    class SetPerformance <<ValueObject>> {
        - SetNumber : int
        - Reps : int
        - Weight : decimal
        - IsWarmup : bool
        - IsDropSet : bool
        - RestSeconds : int
        --
        # GetEqualityComponents() : IEnumerable<object>
    }
}

package "Substitution" {
    class ExerciseSubstitution <<Entity>> {
        - Id : Guid
        - OriginalExerciseId : Guid
        - SubstituteExerciseId : Guid
        - UserId : Guid
        - WorkoutPlanId : Guid
        - Reason : SubstitutionReason
        - SubstitutedDate : DateTime
        - Notes : string
    }
}

package "Enumerations" {
    enum ExerciseCategory <<Enum>> {
        Strength
        Cardio
        Flexibility
        Plyometric
        Olympic
        Strongman
    }

    enum MuscleGroup <<Enum>> {
        Chest
        Back
        Shoulders
        Biceps
        Triceps
        Forearms
        Abs
        Obliques
        Quads
        Hamstrings
        Glutes
        Calves
        FullBody
    }

    enum EquipmentType <<Enum>> {
        Barbell
        Dumbbell
        Kettlebell
        Machine
        Cable
        Bodyweight
        Bands
        Other
    }

    enum SubstitutionReason <<Enum>> {
        EquipmentUnavailable
        Injury
        Preference
        ProgressionChange
    }

    enum WeightUnit <<Enum>> {
        Pounds
        Kilograms
    }

    enum DifficultyLevel <<Enum>> {
        Beginner
        Intermediate
        Advanced
    }
}

package "Domain Events" {
    class ExerciseAddedToLibraryEvent <<DomainEvent>> {
        + ExerciseId : Guid
        + ExerciseName : string
        + Category : string
        + MuscleGroup : string
        + IsCustom : bool
        + CreatedByUserId : Guid?
        + CreatedDate : DateTime
    }

    class ExercisePerformedEvent <<DomainEvent>> {
        + ExerciseId : Guid
        + ExerciseName : string
        + UserId : Guid
        + WorkoutSessionId : Guid
        + TotalSets : int
        + TotalReps : int
        + MaxWeight : decimal
        + TotalVolume : decimal
        + PerformedDate : DateTime
    }

    class ExerciseSubstitutedEvent <<DomainEvent>> {
        + WorkoutPlanId : Guid
        + OriginalExerciseId : Guid
        + OriginalExerciseName : string
        + SubstituteExerciseId : Guid
        + SubstituteExerciseName : string
        + UserId : Guid
        + Reason : string
        + SubstitutedDate : DateTime
    }
}

' Relationships
Exercise "1" *-- "*" SetPerformance : contains
ExercisePerformance "1" *-- "*" SetPerformance : contains
Exercise --> ExerciseCategory
Exercise --> MuscleGroup
Exercise --> EquipmentType
Exercise --> DifficultyLevel
ExercisePerformance --> Exercise : references
ExercisePerformance --> WeightUnit
ExerciseSubstitution --> Exercise : original
ExerciseSubstitution --> Exercise : substitute
ExerciseSubstitution --> SubstitutionReason

Exercise ..> ExerciseAddedToLibraryEvent : raises
ExercisePerformance ..> ExercisePerformedEvent : raises
ExerciseSubstitution ..> ExerciseSubstitutedEvent : raises

note right of Exercise
  Aggregate Root for the Exercise domain.
  Manages exercise library and metadata.
  Can be system-provided or user-created.
end note

note right of ExercisePerformance
  Tracks individual exercise performances
  during workout sessions. Calculates volume
  and strength metrics.
end note

note right of SetPerformance
  Value Object representing a single set.
  Immutable once recorded.
end note

@enduml
