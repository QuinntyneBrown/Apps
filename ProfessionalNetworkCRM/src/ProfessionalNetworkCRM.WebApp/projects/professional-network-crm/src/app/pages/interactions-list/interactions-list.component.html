<ng-container *ngIf="viewModel$ | async as vm">
  <div class="interactions-list">
    <div class="interactions-list__header">
      <h1 class="interactions-list__title">Interactions</h1>
      <button mat-raised-button color="primary" routerLink="/interactions/new" class="interactions-list__add-btn">
        <mat-icon>add</mat-icon>
        Log Interaction
      </button>
    </div>

    <mat-card class="interactions-list__card">
      <table mat-table [dataSource]="vm.interactions" class="interactions-list__table">
        <ng-container matColumnDef="contactId">
          <th mat-header-cell *matHeaderCellDef>Contact</th>
          <td mat-cell *matCellDef="let interaction">{{ vm.contactsMap.get(interaction.contactId) || 'Unknown' }}</td>
        </ng-container>

        <ng-container matColumnDef="interactionType">
          <th mat-header-cell *matHeaderCellDef>Type</th>
          <td mat-cell *matCellDef="let interaction">{{ interaction.interactionType }}</td>
        </ng-container>

        <ng-container matColumnDef="interactionDate">
          <th mat-header-cell *matHeaderCellDef>Date</th>
          <td mat-cell *matCellDef="let interaction">{{ interaction.interactionDate | date:'short' }}</td>
        </ng-container>

        <ng-container matColumnDef="subject">
          <th mat-header-cell *matHeaderCellDef>Subject</th>
          <td mat-cell *matCellDef="let interaction">{{ interaction.subject || '-' }}</td>
        </ng-container>

        <ng-container matColumnDef="outcome">
          <th mat-header-cell *matHeaderCellDef>Outcome</th>
          <td mat-cell *matCellDef="let interaction">{{ interaction.outcome || '-' }}</td>
        </ng-container>

        <ng-container matColumnDef="duration">
          <th mat-header-cell *matHeaderCellDef>Duration</th>
          <td mat-cell *matCellDef="let interaction">
            {{ interaction.durationMinutes ? interaction.durationMinutes + ' min' : '-' }}
          </td>
        </ng-container>

        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef>Actions</th>
          <td mat-cell *matCellDef="let interaction">
            <button mat-icon-button color="primary" (click)="editInteraction(interaction.interactionId)">
              <mat-icon>edit</mat-icon>
            </button>
            <button mat-icon-button color="warn" (click)="deleteInteraction(interaction.interactionId)">
              <mat-icon>delete</mat-icon>
            </button>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;" class="interactions-list__row"></tr>
      </table>
    </mat-card>
  </div>
</ng-container>
